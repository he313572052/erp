<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>工程资料</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="format-detection" content="telephone=no">
		<link rel="stylesheet" href="../../../iconfont/iconfont.css" />
		<link rel="stylesheet" href="../../../layui/css/layui.css" media="all" />
		<link rel="stylesheet" href="../../../css/engineering.css" media="all" />
	</head>

	<body class="childrenBody">
		<div class="layui-fluid">
			<blockquote class="layui-btns">
				<div class="layui-btn-group">
					<button class="layui-btn layui-btn-sm layui-btn-blue btn" data-title="下载" data-event="download"><i class="iconfont icon-download"></i></button>
					<button class="layui-btn layui-btn-sm layui-btn-blue btn" data-title="新增文件" data-event="upload"><i class="layui-icon layui-icon-upload"></i></button>
					<button class="layui-btn layui-btn-sm layui-btn-blue btn" data-title="批量删除" data-event="del"><i class="layui-icon layui-icon-delete"></i></button>
				</div>
			</blockquote>
			<div class="datum-table layui-table-1">
				<div class="layui-table-caption">
					<div>工程资料</div>
					<div></div>
				</div>
				<div>
					<table class="layui-table layui-simple-table layui-form" lay-skin="line">

						<colgroup>
							<col>
							<col>
							<col>
							<col>
							<col>
							<col>
							<col>
							<col>
							<col>
						</colgroup>
						<thead>
							<tr>
								<th><input type="checkbox" name="" title="" lay-skin="primary" lay-filter="allChoose"></th>
								<th>文件分类</th>
								<th>文件名</th>
								<th>上传日期</th>
								<th>上传人</th>
								<th>最后变更人</th>
								<th>最后变更日期</th>
								<th>变更次数</th>
								<th>文件类型</th>

							</tr>
						</thead>
						<tbody>
							<tr id='node-1' class="parent collapsed">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="1"></td>
								<td>
									<a class="layui-btn layui-btn-xs layui-btn-normal showSubBtn" data-id='1'>+</a>
									<b style="color: #000;">工程文件</b>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr id='node-2' class="child-node-1" style="display:none ;" parentid="1">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="2"></td>
								<td>├─</td>
								<td>制作清单-CW.xls
								</td>
								<td>2018-06-29 12:00</td>
								<td>刘子儒</td>
								<td></td>
								<td></td>
								<td>0</td>
								<td>.xls</td>
							</tr>
							<tr id='node-3' class="child-node-1" style="display:none ;" parentid="1">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="3"></td>
								<td>├─</td>
								<td>制作清单-CW.xls
								</td>
								<td>2018-06-29 12:00</td>
								<td>刘子儒</td>
								<td></td>
								<td></td>
								<td>0</td>
								<td>.xls</td>
							</tr>
							<tr id='node-4' class="child-node-1" style="display:none ;" parentid="1">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="4"></td>
								<td>├─</td>
								<td>制作清单-CW.xls
								</td>
								<td>2018-06-29 12:00</td>
								<td>刘子儒</td>
								<td></td>
								<td></td>
								<td>0</td>
								<td>.xls</td>
							</tr>
							<tr id='node-5' class="parent collapsed">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="5"></td>
								<td>
									<a class="layui-btn layui-btn-xs layui-btn-normal showSubBtn" data-id='5'>+</a>
									<b style="color: #000;">加工程式单</b>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr id='node-6' class="child-node-5" style="display:none ;" parentid="5">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="6"></td>
								<td>├─</td>
								<td>制作清单-CW.xls
								</td>
								<td>2018-06-29 12:00</td>
								<td>刘子儒</td>
								<td></td>
								<td></td>
								<td>0</td>
								<td>.xls</td>
							</tr>
							<tr id='node-7' class="child-node-5" style="display:none ;" parentid="5">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="7"></td>
								<td>├─</td>
								<td>制作清单-CW.xls
								</td>
								<td>2018-06-29 12:00</td>
								<td>刘子儒</td>
								<td></td>
								<td></td>
								<td>0</td>
								<td>.xls</td>
							</tr>
							<tr id='node-8' class="parent collapsed">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="8"></td>
								<td>
									<a class="layui-btn layui-btn-xs layui-btn-normal showSubBtn" data-id='8'>+</a>
									<b style="color: #000;">NC文件</b>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
							<tr id='node-9' class="child-node-8" style="display:none ;" parentid="8">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="9"></td>
								<td>├─</td>
								<td>制作清单-CW.xls
								</td>
								<td>2018-06-29 12:00</td>
								<td>刘子儒</td>
								<td></td>
								<td></td>
								<td>0</td>
								<td>.xls</td>
							</tr>
							<tr id='node-10' class="parent collapsed">
								<td><input type="checkbox" name="" lay-skin="primary" data-id="10"></td>
								<td>
									<a class="layui-btn layui-btn-xs layui-btn-normal showSubBtn" data-id='10'>+</a>
									<b style="color: #000;">高光文件</b>
								</td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<script type="text/javascript" src="../../../layui/layui.js"></script>
		<script type="text/javascript">
			var row;
			layui.use(['jquery', 'form', 'layer', 'table', 'upload'], function() {
				var $ = layui.jquery,
					form = layui.form,
					table = layui.table,
					upload = layui.upload,
					_layer = layui.layer,
					layer = parent.layer == undefined ? laui.layer : parent.layer;
				$('.btn').mouseenter(function() {
					var title = $(this).attr('data-title');
					_layer.tips(title, this, {
						tips: [1, '#1E82D2']
					})
				}).click(function() {
					var layEvent = $(this).data('event');
					var title = $(this).data('title');
					if(layEvent === 'upload') {
						E.page(title, '../engineering/code/code-upload.html', '600px',
							'425px')
					} else if(layEvent === 'del') {
						E.tip(row, function() {
							layer.confirm('您确定删除吗？', {
								title: '询问',
								icon: 3
							}, function(index) {
								layer.msg('删除成功');
							})
						});
					} else if(layEvent === 'download') {
						E.tip(row, function() {
							E.showLoad('下载成功');
						})
					}
				});
				//展开隐藏
				$('.showSubBtn').on('click', function() {
					var _this = $(this);
					var id = _this.attr('data-id');
					var parent = _this.parents('.parent');
					var child = $('.child-node-' + id);
					var childAll = $('tr[parentid=' + id + ']');
					if(parent.hasClass('collapsed')) {
						_this.html('-');
						parent.addClass('expanded').removeClass('collapsed');
						child.css('display', '');
					} else {
						_this.html('+');
						parent.addClass('collapsed').removeClass('expanded');
						child.css('display', 'none');
						childAll.addClass('collapsed').removeClass('expanded').css('display',
							'none');
						childAll.find('.showSubBtn').html('+');
					}

				})
				//全选
				form.on('checkbox(allChoose)', function(data) {
					var child = $(data.elem).parents('table').find(
						'tbody input[type="checkbox"]');
					child.each(function(index, item) {
						item.checked = data.elem.checked;
					});
					form.render('checkbox');
				});
				//行点击事件
				$('.layui-table.layui-simple-table').on('click', 'tr', function() {
					var isParent = $(this).hasClass('parent');
					if(isParent) return;
					$(this).addClass('tr-selected').siblings('tr').removeClass(
						'tr-selected');
					row = $(this).children('td').eq(0).find('input').attr('data-id');
				})
				var E = (function(obj) {
					obj.page = function(title, url, w, h) {
						layer.open({
							type: 2,
							skin: 'layer-skin-class',
							resize: false,
							title: title,
							area: [w, h],
							content: url
						});
					}
					obj.showLoad = function(msg) {
						layer.load(1, {
							time: 2 * 1000
						})
						setTimeout(function() {
							layer.msg(msg);
						}, 2 * 1000)
					}
					obj.tip = function(row, callback) {
						if(!row) {
							layer.msg('请选择行');
							return;
						}
						if(callback !== undefined && typeof(callback) === 'function') {
							callback();
						}
					}
					return obj
				})(E || {})
			});
		</script>
	</body>

</html>